<!DOCTYPE html>
<html lang="zh_CN" xmlns:th="http://www.thymeleaf.org">

<head th:replace="common/head :: common_header(~{::title},~{::link},~{::script},~{::style})">
    <title>开票管理</title>
    <link href="/css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="/layui/css/layui.css" rel="stylesheet">
    <script type="text/javascript" src="/js/plugins/jparticle.jquery.js"></script>
    <link rel="stylesheet" href="/js/plugins/layer/laydate/skins/default/laydate.css">
    <script src="/js/plugins/layer/laydate/laydate.js"></script>
    <script src="/layui/layui.js"></script>
    <link rel="stylesheet" href="/css/plugins/jQueryUI/jquery-ui-1.10.4.custom.min.css"/>
    <script src="/js/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script type="text/javascript" src="/js/plugins/treeview/bootstrap-treeview.js"></script>
    <script th:src="@{/js/crm/common_util.js(v=${version})}"  data-th-inline="javascript"></script>
    <script th:src="@{/js/fee/commonFee.js(v=${version})}"  data-th-inline="javascript"></script>
    <script th:src="@{/js/process/approveTask.js(v=${version})}"  data-th-inline="javascript"></script>
    <script th:src="@{/js/fee/queryInvoice.js(v=${version})}"  data-th-inline="javascript"></script>
    <style>
        .companyWrap {
            border: 1px solid #eeeeee;
            width: 95.6%;
            height: 212px;
            position: absolute;
            top: 34px;
            background-color: white;
            z-index: 999;
            overflow-y: auto;
            overflow-x: hidden;
        }
        .companyNameItem {
            border-bottom: 1px solid #eeeeee;
            width: 100%;
            height: 30px;
            float: left;
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 0 12px;
        }
        .companyNameItem:hover{
            background-color: #DFF0D8;
        }

        .companyNameItem > span{
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
        .text-green {
            color: #18a689;
        }
        .companyPanelCancel {
            display: none;
        }
    </style>
    <script>
        $(function () {
            $('.i-checks').iCheck({
                checkboxClass: 'icheckbox_square-green',
                radioClass: 'iradio_square-green',
            });
            //回车提交事件
            $('#queryDiv').on('keypress', function (event) {
                if (event.keyCode == "13") {
                    $("#querySearch").click();
                }
            });
            $('#firstDiv').on('keypress', function (event) {
                if (event.keyCode == "13") {
                    $("#custSearch").click();
                }
            });
            $('#secondDiv').on('keypress', function (event) {
                if (event.keyCode == "13") {
                    $("#articleSearch").click();
                }
            });
            var startTimeQc = {
                elem: '#startTimeQc',
                format: 'YYYY/MM/DD ',
                // min: laydate.now(), //设定最小日期为当前日期
                // max: laydate.now(),//最大日期
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // endTimeQc.min = datas; //开始日选好后，重置结束日的最小日期
                    // endTimeQc.start = datas //将结束日的初始值设定为开始日
                    var startTime = $("#startTimeQc").val();
                    var endTime = $("#endTimeQc").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#startTimeQc").val("")
                        return;
                    }
                }
            };
            var endTimeQc = {
                elem: '#endTimeQc',
                format: 'YYYY/MM/DD ',
                //min: laydate.now(),
                // max: laydate.now(),
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // startTimeQc.max = datas; //结束日选好后，重置开始日的最大日期
                    var startTime = $("#startTimeQc").val();
                    var endTime = $("#endTimeQc").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#endTimeQc").val("")
                        return;
                    }
                }
            };

            var startTime = {
                elem: '#startTime',
                format: 'YYYY/MM/DD ',
                // min: laydate.now(), //设定最小日期为当前日期
                // max: laydate.now(),//最大日期
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // endTime.min = datas; //开始日选好后，重置结束日的最小日期
                    // endTime.start = datas //将结束日的初始值设定为开始日
                    var startTime = $("#startTime").val();
                    var endTime = $("#endTime").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#startTime").val("")
                        return;
                    }
                }
            };
            var endTime = {
                elem: '#endTime',
                format: 'YYYY/MM/DD ',
                //min: laydate.now(),
                // max: laydate.now(),
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // startTime.max = datas; //结束日选好后，重置开始日的最大日期
                    var startTime = $("#startTime").val();
                    var endTime = $("#endTime").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#endTime").val("")
                        return;
                    }
                }
            };

            var applyStartTimeQc = {
                elem: '#applyStartTimeQc',
                format: 'YYYY/MM/DD ',
                // min: laydate.now(), //设定最小日期为当前日期
                // max: laydate.now(),//最大日期
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // applyEndTimeQc.min = datas; //开始日选好后，重置结束日的最小日期
                    // applyEndTimeQc.start = datas //将结束日的初始值设定为开始日
                    var startTime = $("#applyStartTimeQc").val();
                    var endTime = $("#applyEndTimeQc").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#applyStartTimeQc").val("")
                        return;
                    }
                }
            };
            var applyEndTimeQc = {
                elem: '#applyEndTimeQc',
                format: 'YYYY/MM/DD ',
                //min: laydate.now(),
                // max: laydate.now(),
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // applyStartTimeQc.max = datas; //结束日选好后，重置开始日的最大日期
                    var startTime = $("#applyStartTimeQc").val();
                    var endTime = $("#applyEndTimeQc").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#applyEndTimeQc").val("")
                        return;
                    }
                }
            };

            laydate(startTimeQc);
            laydate(endTimeQc);
            laydate(startTime);
            laydate(endTime);
            laydate(applyStartTimeQc);
            laydate(applyEndTimeQc);

            var issueStartTime = {
                elem: '#issueStartTime',
                format: 'YYYY/MM/DD ',
                // min: laydate.now(), //设定最小日期为当前日期
                // max: laydate.now(),//最大日期
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // issueEndTime.min = datas; //开始日选好后，重置结束日的最小日期
                    // issueEndTime.start = datas //将结束日的初始值设定为开始日
                    var startTime = $("#issueStartTime").val();
                    var endTime = $("#issueEndTime").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#issueStartTime").val("")
                        return;
                    }
                }
            };
            var issueEndTime = {
                elem: '#issueEndTime',
                format: 'YYYY/MM/DD ',
                //min: laydate.now(),
                // max: laydate.now(),
                istime: false,
                istoday: false,
                choose: function (datas) {
                    // issueStartTime.max = datas; //结束日选好后，重置开始日的最大日期
                    var startTime = $("#issueStartTime").val();
                    var endTime = $("#issueEndTime").val();
                    if(startTime && endTime && startTime > endTime){
                        layer.msg("开始时间不能大于结束时间");
                        $("#issueEndTime").val("")
                        return;
                    }
                }
            };
            laydate(issueStartTime);
            laydate(issueEndTime);
            $("#editModal").draggable();
        });
    </script>
</head>
<div class="row">
    <div class="col-sm-12">
        <div class="ibox" style="margin-bottom: 0px">
            <div class="ibox-title" style="padding-left: 20px">
                <h5 style="font-weight: bold">查询条件</h5>
            </div>
            <div class="ibox-content" style="padding: 15px 20px 0px 20px">
                <div class="form-horizontal" id="queryDiv">
                    <form id="queryForm">
                        <div class="form-group">
                            <label class="col-sm-1 control-label">申请日期:</label>
                            <div class="col-sm-2" style="min-width:240px;">
                                <input placeholder="开始日期" style="width:48%;vertical-align: middle"
                                       class="form-control layer-date laydate-icon " id="applyStartTimeQc"
                                       name="applyStartTimeQc" readonly="readonly">
                                <!--<span style="display:inline-block;padding:0 1px;">至</span>-->
                                <input placeholder="结束日期" style="width:48%;vertical-align: middle"
                                       class="form-control layer-date laydate-icon" id="applyEndTimeQc"
                                       name="applyEndTimeQc" readonly="readonly">
                            </div>
                            <div class="col-sm-2">
                                <input type="text" id="codeQc" name="codeQc" class="form-control"
                                       placeholder="申请编号">
                            </div>
                            <div class="col-sm-2">
                                <input type="text" id="nameQc" name="nameQc" class="form-control" placeholder="标题">
                            </div>
                            <div class="col-sm-2">
                                <input type="text" id="custCompanyNameQc" name="custCompanyNameQc"
                                       class="form-control" placeholder="客户公司名称">
                            </div>
                            <div class="col-sm-1">
                                <input type="text" id="custNameQc" name="custNameQc" class="form-control"
                                       placeholder="联系人">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-1 control-label">开票日期:</label>
                            <div class="col-sm-2" style="min-width:240px;">
                                <input placeholder="开始日期" style="width:48%;vertical-align: middle"
                                       class="form-control layer-date laydate-icon" id="startTimeQc"
                                       name="startTimeQc" readonly="readonly">
                                <!--<span style="display:inline-block;padding:0 10px;"></span>-->
                                <input placeholder="结束日期" style="width:48%;vertical-align: middle"
                                       class="form-control layer-date laydate-icon" id="endTimeQc" name="endTimeQc"  readonly="readonly">
                            </div>
                            <div class="col-sm-1">
                                <select class="form-control" name="invoiceTypeQc">
                                    <option value="">类型</option>
                                    <option value="0">未指定</option>
                                    <option value="1">普票</option>
                                    <option value="2">专票</option>
                                </select>
                            </div>
                            <div class="col-sm-1">
                                <select class="form-control" name="stateQc">
                                    <option value="">状态</option>
                                    <option value="-1">已驳回</option>
                                    <option value="0">已保存</option>
                                    <option value="2">审核中</option>
                                    <option value="3">确认中</option>
                                    <option value="4">开票中</option>
                                    <option value="1">已完成</option>
                                </select>
                            </div>
                            <div class="col-sm-1">
                                <input type="text" name="taxType" class="form-control" placeholder="抬头">
                            </div>
                            <div class="col-sm-1">
                                <input type="text" id="applyNameQc" name="applyNameQc" class="form-control"
                                       placeholder="申请人">
                            </div>
                            <div class="col-sm-2" id="deptDiv" style="display:none">
                                <div class="input-group m-b" style="margin-bottom: 0">
                                    <input type="hidden" id="deptId" name="deptId" class="height18">
                                    <input type="text" id="chooseDeptName" class="form-control height18" readonly="readonly">
                                    <span class="input-group-addon btn btn-primary glyphicon glyphicon-search"
                                          style="top: 0px;border: 1px solid #1ab394;border-radius: 3px;background-color: #1ab394;color: #FFFFFF" id="selDept"
                                          data-toggle="tooltip" data-placement="top" data-html="true" title="选择部门"></span>
                                    <span class="input-group-addon btn btn-primary glyphicon glyphicon-remove"
                                          style="top: 0px;border: 1px solid #f8ac59;border-radius: 3px;background-color: #f8ac59;color: #FFFFFF" id="cleanDept"
                                          data-toggle="tooltip" data-placement="top" data-html="true" title="清除选择的部门"></span>
                                </div>
                            </div>
                            <div class="col-sm-1">
                                <button type="button" id="querySearch" onclick="gridObj.reloadTable();" class="btn btn-primary">
                                    <i class="fa fa-search "></i>&nbsp;&nbsp;搜索
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-12">
        <div class="ibox ">
            <div class="ibox-title" style="padding-left: 20px">
                <button id="addBtn" class="btn btn-success" type="button" onclick="businessObj.add();">
                    <i class="fa fa-plus"></i>&nbsp;申请开票
                </button>
                <button id="exportBtn" class="btn btn-info" type="button" onclick="businessObj.exportInvoice();">
                    <i class="glyphicon glyphicon-export"></i>&nbsp;&nbsp;导&nbsp;出&nbsp;
                </button>
            </div>
            <div class="ibox-content" style="padding: 5px 0px 0px 5px">
                <div class="jqGrid_wrapper">
                    <table id="query_table_logs"></table>
                    <div id="query_pager_logs"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--新增编辑页面-->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel">
    <div class="modal-dialog" role="document" style="width: 100%">
        <div class="modal-content">
            <div class="fa fa-refresh" id="refresh" style="margin-left: 20px; margin-top: 20px;cursor: pointer"
                 title="刷新"></div>
            <div class="modal-header" style="padding-top: 0px; padding-bottom: 5px;">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h1 class="modal-title" style="text-align: center">开票信息</h1>
            </div>
            <div class="modal-body" style="padding:5px">
                <div class="tabs-container">
                    <ul class="nav nav-tabs" id="navTabs">
                        <li class="active firstDiv"><a data-toggle="tab" id="firstStep" href="#firstDiv"
                                                       aria-expanded="true">第一步选择客户</a>
                        </li>
                        <li class="secondDiv"><a data-toggle="tab" id="secondStep" href="#secondDiv"
                                                 aria-expanded="false">第二步选择稿件</a>
                        </li>
                        <li class="thirdDiv"><a data-toggle="tab" id="thirdStep" href="#thirdDiv"
                                                aria-expanded="false">第三步完善发票信息</a>
                        </li>
                    </ul>
                    <div class="tab-content ">
                        <div id="firstDiv" class="tab-pane active" style="margin-top:15px;">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="ibox" style="margin-bottom: 0">
                                        <div>
                                            <form id="firstForm"  class="form-horizontal">
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">客户公司名称:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="companyNameQc1" name="companyName"
                                                               class="form-control">
                                                    </div>
                                                    <label class="col-sm-2 control-label">对接人:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="custNameQc1" name="custName"
                                                               class="form-control">
                                                    </div>
                                                    <div class="col-sm-1">
                                                        <button type="button" id="custSearch" onclick="gridObj.reloadCust();"
                                                                class="btn btn-primary">
                                                            <i class="fa fa-search"></i>&nbsp;&nbsp;搜索
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="ibox-content" style="padding: 15px 0 0 0">
                                            <div class="jqGrid_wrapper">
                                                <table id="select_cust_table_logs"></table>
                                                <div id="select_cust_pager_logs"></div>
                                            </div>
                                            <div style="padding: 5px">
                                                <span class="text-red">温馨提示：1、企业客户是强保护类型才能开票；2、个体工商户手机号码规范才能开票。</span>
                                            </div>
                                            <div style="padding: 5px"><span class="text-red">开票规则：1、企业客户开票：开票公司名称必须是客户公司名称；2、个人客户开票：开票公司名称必须是对接人名字。</span></div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-success" onclick="businessObj.initArticle();"
                                                id="selectSupplier"><i class="fa fa-forward"></i>下一步
                                        </button>
                                        <button type="button" class="btn btn-white"
                                                data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="secondDiv" class="tab-pane" style="margin-top:15px;">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="ibox" style="margin-bottom: 0">
                                        <div>
                                            <form id="secondForm"  class="form-horizontal">
                                                <div class="form-group">
                                                    <label class="col-sm-1 control-label">发布日期:</label>
                                                    <div class="col-sm-3" style="min-width:240px;">
                                                        <input placeholder="开始日期" style="width:48%;vertical-align: middle"
                                                               class="form-control layer-date laydate-icon " id="startTime"
                                                               name="startTime" readonly="readonly">
                                                        <input placeholder="结束日期" style="width:48%;vertical-align: middle"
                                                               class="form-control layer-date laydate-icon " id="endTime"
                                                               name="endTime" readonly="readonly">
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <input type="text" id="brandQc" name="brandQc" class="form-control" placeholder="品牌">
                                                    </div>
                                                    <div class="col-sm-1">
                                                        <input type="text" id="mediaUserNameQc" name="mediaUserNameQc"
                                                               class="form-control" placeholder="媒介">
                                                    </div>
                                                    <div class="col-sm-1">
                                                        <input type="text" id="mediaNameQc" name="mediaNameQc"
                                                               class="form-control" placeholder="媒体">
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <input type="text" id="titleQc" name="titleQc" class="form-control" placeholder="标题">
                                                    </div>
                                                    <input type="hidden" id="custCompanyIdSec" name="custCompanyId">
                                                    <input type="hidden" id="custCompanyNameSec" name="custCompanyName">
                                                    <input type="hidden" id="custIdSec" name="custId">
                                                    <input type="hidden" id="custNameSec" name="custName">
                                                    <input type="hidden" id="articleIdsSec" name="articleIdsSec">
                                                    <input type="hidden" id="checkState" name="checkState">
                                                    <!--客户有效期开始时间和结束时间，只能选择在有效期内的稿件-->
                                                    <input type="hidden" id="startTimeSec" name="startTimeSec">
                                                    <input type="hidden" id="endTimeSec" name="endTimeSec">
                                                    <div class="col-sm-1">
                                                        <button type="button" id="articleSearch" class="btn btn-primary" onclick="businessObj.articleSearch();">
                                                            <i class="fa fa-search"></i>&nbsp;&nbsp;搜索
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <div class="ibox-content" style="padding: 0;">
                                            <div style="background-color: aliceblue"><h3 style="font-weight: bold; padding: 14px 15px 7px 20px; margin-bottom: 0px;margin-top: 0px;">未开票未提成的稿件列表</h3></div>
                                            <div class="col-sm-12" style="padding:5px">
                                                <div class=" radio-inline i-checks" style="text-align: right;float: left">
                                                    <span><input name="checkboxState" type="checkbox" value="1"/>选择列表中的所有稿件</span>
                                                    <span>&nbsp;&nbsp;勾选后所有查询出的稿件都会被选中，表格中的全选框只能选中当前页！</span>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 text-right" style="margin-right:10px">
                                                <label style="margin-left: 52px">总报价合计:￥</label>
                                                <span id="saleSum1" class="text-danger">0</span>
                                                <label style="margin-left: 52px">选中报价合计:￥</label>
                                                <span id="saleSum2" class="text-danger">0</span>
                                                <!--                                                <label style="margin-left: 52px">进账合计:￥</label>-->
                                                <!--                                                <span id="incomeSum1" class="text-danger">0</span>-->
                                                <label style="margin-left: 52px">选中进账合计：￥</label>
                                                <span id="incomeSum2" class=" text-danger">0</span>
                                                <!--                                                <label style="margin-left: 52px">成本合计:￥</label>-->
                                                <!--                                                <span id="outgoSum1" class="text-danger">0</span>-->
                                                <label style="margin-left: 52px">选中成本合计:￥</label>
                                                <span id="outgoSum2" class="text-danger">0</span>
                                            </div>
                                            <div class="jqGrid_wrapper">
                                                <table id="select_article_table_logs"></table>
                                                <div id="select_article_pager_logs"></div>
                                            </div>
                                            <div style="padding: 5px">
                                                <span>温馨提示：发布日期在客户有效期内的稿件才会显示在列表中，该客户有效期：</span>
                                                <span class="text-red" id="startTimeText"></span>
                                                <span>&nbsp;~&nbsp;</span>
                                                <span class="text-red" id="endTimeText"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary " id="backStepOne" onclick="businessObj.initCust(false);">
                                            <i class="fa fa-backward"></i>上一步
                                        </button>
                                        <button type="button" class="btn btn-success" id="selectArticle" onclick="businessObj.selectArticle();">
                                            <i class="fa fa-forward"></i>下一步
                                        </button>
                                        <button type="button" class="btn btn-white"
                                                data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="thirdDiv" class="tab-pane" style="margin-top:15px;">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="ibox" style="margin-bottom: 0">
                                        <div>
                                            <form id="editForm"  class="form-horizontal">
                                                <div class="form-group">
                                                    <label class="col-sm-1 control-label">标题:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="name" name="name" class="form-control" autocomplete="off">
                                                    </div>
                                                    <label class="col-sm-1 control-label">客户公司<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="hidden" id="custCompanyId" name="custCompanyId"
                                                               class="form-control">
                                                        <input type="text" id="custCompanyName" name="custCompanyName"
                                                               class="form-control" required="" readonly="readonly">
                                                    </div>
                                                    <label class="col-sm-1 control-label">联系人<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="hidden" id="custId" name="custId" class="form-control">
                                                        <input type="text" id="custName" name="custName"
                                                               class="form-control" required="" readonly="readonly">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-1 control-label">开票公司名称<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="title" name="title" class="form-control"
                                                               required=""  autocomplete="off">
                                                    </div>
                                                    <label class="col-sm-1 control-label">税号<span class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="taxCode" name="taxCode" class="form-control"
                                                               required=""  autocomplete="off">
                                                    </div>
                                                    <label class="col-sm-1 control-label">公司地址<span
                                                            class="text-red invoiceStar">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="address" name="address"
                                                               class="form-control specInvoice" autocomplete="off">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-1 control-label">公司电话<span
                                                            class="text-red invoiceStar">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="phone" name="phone"
                                                               class="form-control specInvoice"  autocomplete="off">
                                                    </div>
                                                    <label class="col-sm-1 control-label">开户行<span
                                                            class="text-red invoiceStar">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="bankName" name="bankName"
                                                               class="form-control specInvoice"  autocomplete="off">
                                                    </div>
                                                    <label class="col-sm-1 control-label">银行账号<span
                                                            class="text-red invoiceStar">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="bankNo" name="bankNo"
                                                               class="form-control specInvoice" autocomplete="off">
                                                    </div>
                                                </div>
                                                <div class="form-group ">
                                                    <label class="col-sm-1 control-label">发票类型<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <div class="radio i-checks">
                                                            <input type="radio" value="0" name="invoiceType"/>未指定
                                                            <input type="radio" value="1" name="invoiceType"/>普票
                                                            <input type="radio" value="2" name="invoiceType"/>专票
                                                        </div>
                                                    </div>
                                                    <label class="col-sm-1 control-label">劳务名称:</label>
                                                    <div class="col-md-3">
                                                        <input type="text" id="labourService" name="labourService"
                                                               class="form-control" autocomplete="off">
                                                    </div>
                                                    <label class="col-sm-1 control-label">价税合计<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="amount" name="amount" class="form-control" autocomplete="off"
                                                               required="" readonly="readonly">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-1 control-label">实际开票金额<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="invoiceAmount" name="invoiceAmount"
                                                               class="form-control" required="" autocomplete="off"
                                                               onkeyup="this.value=this.value.toString().match(/^\d+(?:\.\d{0,2})?/)">
                                                    </div>
                                                    <label class="col-sm-1 control-label">抬头<span class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <div id="taxesDiv"></div>
                                                    </div>
                                                    <label class="col-sm-1 control-label">税点<span class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="hidden" id="ratio" name="ratio"
                                                               class="form-control" required="" readonly="readonly">
                                                        <input type="text" id="taxPoint" name="taxPoint" autocomplete="off"
                                                               class="form-control" required="" readonly="readonly">
                                                    </div>
                                                </div>
                                                <div class="form-group " id="viewAndInvoice">
                                                    <label class="col-sm-1 control-label">税额<span class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="taxAmount" name="taxAmount" autocomplete="off"
                                                               class="form-control" required="" readonly="readonly">
                                                    </div>
                                                    <label class="col-sm-1 control-label">申请人<span class="text-red">*</span>:</label>
                                                    <div class="col-sm-2">
                                                        <input type="text" id="deptName" name="deptName"
                                                               class="form-control" required="" readonly="readonly">
                                                    </div>
                                                    <div class="col-sm-1">
                                                        <input type="text" id="applyName" name="applyName"
                                                               class="form-control" required="" readonly="readonly">
                                                    </div>
                                                    <label class="col-sm-1 control-label">编号<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="text" id="code" name="code"
                                                               class="form-control" required="" readonly="readonly">
                                                    </div>
                                                </div>
                                                <div class="form-group" id="hideOnEdit">
                                                    <label class="col-sm-1 control-label">状态<span class="text-red">*</span>:</label>
                                                    <div class="col-sm-3">
                                                        <input type="hidden" id="state" name="state" class="form-control"
                                                               value="0">
                                                        <input type="text" id="state1" name="state1" class="form-control"
                                                               style="border:0;">
                                                    </div>
                                                    <label class="col-sm-1 control-label showOnInvoice">发票编号:</label>
                                                    <div class="col-sm-3 showOnInvoice">
                                                        <input type="text" id="no" name="no" class="form-control"
                                                               readonly="readonly">
                                                    </div>
                                                    <label class="col-sm-1 control-label showAfterInvoice">开票日期<span
                                                            class="text-red">*</span>:</label>
                                                    <div class="col-sm-3 showAfterInvoice">
                                                        <input type="text" id="invoiceTime" name="invoiceTime"
                                                               class="form-control" readonly="readonly">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-1 control-label">备注:</label>
                                                    <div class="col-sm-11">
                                                    <textarea id="invoiceDesc" name="invoiceDesc"
                                                              class="form-control"></textarea>
                                                    </div>
                                                </div>
                                                <div class="form-group" style="margin-bottom: 0px">
                                                    <input type="hidden" id="id" name="id" class="form-control">
                                                    <input type="hidden" id="flag" name="flag" class="form-control">
                                                    <input type="hidden" id="selRow" name="selRow">
                                                    <!--taskId如果是null，则是第一次提交，taskId有值，则表示是驳回后提交，走的审核流程不一样-->
                                                    <input type="hidden" id="taskId" name="taskId">
                                                    <input type="hidden" id="companyCode" name="companyCode">
                                                </div>
                                            </form>
                                        </div>
                                        <div class="ibox-content" style="padding: 0 0 10px 0">
                                            <div style="background-color: aliceblue"><h3 style="font-weight: bold; padding: 14px 15px 7px 20px; margin-bottom: 0px;margin-top: 0px;">开票关联的稿件列表</h3></div>
                                            <div class="ibox-title">
                                                <form id="selectedForm" class="form-horizontal">
                                                    <div class="form-group">
                                                        <label class="col-sm-1 control-label">发布日期:</label>
                                                        <div class="col-sm-4" style="min-width:240px;">
                                                            <input placeholder="开始日期"
                                                                   style="width:48%;vertical-align: middle"
                                                                   class="form-control layer-date laydate-icon "
                                                                   id="issueStartTime" name="issueStartTime" readonly="readonly">
                                                            <!--<span style="display:inline-block;padding:0 1px;">至</span>-->
                                                            <input placeholder="结束日期"
                                                                   style="width:48%;vertical-align: middle"
                                                                   class="form-control layer-date laydate-icon"
                                                                   id="issueEndTime" name="issueEndTime" readonly="readonly">
                                                        </div>
                                                        <input type="hidden" name="id">
                                                        <div class="col-sm-1">
                                                            <button type="button" id="selectedSearch" onclick="gridObj.reloadSelectedArticle();"
                                                                    class="btn btn-primary">
                                                                <i class="fa fa-search "></i>&nbsp;&nbsp;搜索
                                                            </button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="col-sm-12 text-right" style="margin-right:10px">
                                                <label>报价合计:￥</label>
                                                <span id="saleSum" class="text-danger">0</span>
                                                <label style="margin-left: 52px">进账合计：￥</label>
                                                <span id="incomeSum" class=" text-danger">0</span>
                                                <label style="margin-left: 52px">成本合计:￥</label>
                                                <span id="outgoSum" class="text-danger">0</span>
                                                <label style="margin-left: 52px">税金合计:￥</label>
                                                <span id="taxSum" class="text-danger">0</span>
                                            </div>
                                            <div class="jqGrid_wrapper" style="padding-left: 5px;padding-right: 5px">
                                                <table id="selected_article_table_logs"></table>
                                                <div id="selected_article_pager_logs"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer" style="padding: 10px">
                                        <div id="editFooter">
                                            <button type="button" class="btn btn-success " id="save"
                                                    onclick="businessObj.submitHander(this,'/invoice/edit')"><i class="fa fa-check"></i>提交审核
                                            </button>
                                            <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭</button>
                                        </div>
                                        <div id="viewFooter">
                                            <div id="auditTrue" align="center" class="">
                                                <div class="col-sm-9">
                                                    <div class="form-group col-sm-5 licence">
                                                        <label class="col-sm-4 control-label">
                                                            <span class="text-red">*</span>财务助理审核:
                                                        </label>
                                                        <div class="col-sm-5 layui-form">
                                                            <input type="hidden" id="userId" name="userId">
                                                            <input type="hidden" id="userName" name="userName">
                                                            <input type="hidden" id="userDept" name="userDept">
                                                            <select id="financialAssistant" name="financialAssistant" class="form-control" lay-verify="" lay-search placeholder="请选择审核人名称">
                                                            </select>

                                                        </div>
                                                        <span style="font-size: 10px;color: red">如没有审核人员，请联系财务配置该抬头的负责人员</span>
                                                    </div>

                                                    <button type="button" class="btn btn-info" id="showHistory1"
                                                            onclick="businessObj.showHistory($('#showHistory1').data('id'))">审核详情
                                                    </button>
                                                    <button type="button" class="btn btn-primary licence" id="agreeEmploy" onclick="completeApprove(0)">
                                                        审核通过
                                                    </button>
                                                    <button type="button" class="btn btn-success" id="approve1"
                                                            onclick="approve(this)">审核通过
                                                    </button>
                                                    <button type="button" class="btn btn-danger" id="reject1"
                                                            onclick="reject(this)">审核驳回
                                                    </button>
                                                    <button type="button"
                                                            class="btn btn-primary"
                                                            onclick="goBackProcess()"><i class="fa fa-mail-reply"></i>&nbsp;返回
                                                    </button>
                                                </div>
                                                <div class="col-sm-3">
                                                    <label class="col-sm-3 control-label">审核意见:</label>
                                                    <div class="col-sm-7">
                                                        <input type="text" id="desc" class="form-control">
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="auditFalse" class="">
                                                <button type="button" class="btn btn-success  glyphicon glyphicon-ok" id="confirm"
                                                        onclick="businessObj.confirmInfo()">确认开票
                                                </button>
                                                <button type="button" id="KJReturn" class="btn btn-danger glyphicon glyphicon-repeat"
                                                        onclick="businessObj.CWReject()">撤回
                                                </button>
                                                <button type="button" class="btn btn-white" id="cancel1"
                                                        data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭
                                                </button>
                                                <button type="button" id="goback" class="btn btn-white"
                                                        onclick="goBackHtml()"><i class="fa fa-mail-reply"></i>&nbsp;返回
                                                </button>
                                            </div>
                                        </div>
                                        <div id="invoiceFooter">
                                            <label class="col-sm-1 control-label">审核意见:</label>
                                            <div class="col-sm-2">
                                                <input type="text" id="desc1" class="form-control" required="" >
                                            </div>
                                            <button type="button" class="btn btn-success  glyphicon glyphicon-ok" id="invoice"
                                                    onclick="businessObj.invoice(this,'/invoice/invoice')">助理开票
                                            </button>
                                            <button type="button" id="ZLReturn" class="btn btn-danger glyphicon glyphicon-repeat" onclick="reject(this)">
                                                撤回
                                            </button>
                                            <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<!--选择银行账号-->
<div class="modal inmodal" id="accountModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="width:1300px">
        <div class="modal-content animated bounceInRight">
            <div class="modal-body">
                <div class="wrapper wrapper-content  animated fadeInRight">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="ibox ">
                                <div class="ibox-title">
                                    <h5></h5>
                                </div>
                                <div class="ibox-content">
                                    <div class="jqGrid_wrapper">
                                        <table id="account_table_logs"></table>
                                        <div id="account_pager_logs"></div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary selectAccount" id="selectAccount">选择
                                    </button>
                                    <button type="button" class="btn btn-white" id="cancelAccount" data-dismiss="modal">
                                        关闭
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--审核流程详情-->
<div class="modal inmodal" id="historyModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="width:900px">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h4 class="modal-title">审核流程详情</h4>
            </div>
            <div class="ibox-content">
                <div class="form-horizontal">
                    <div>
                        <div class="row">
                            <div id="history" class="col-sm-12">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="position:relative;z-index:2;">
                <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>
<!--搜索条件选择部门-->
<div class="modal inmodal" id="deptModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h1>选择部门</h1>
            </div>
            <div class="modal-body" style="padding: 0px">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="ibox" style="margin-bottom: 0">
                            <div class="ibox-content">
                                <div id="treeview"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭
                </button>
            </div>
        </div>
    </div>
</div>
<!-- 修改公司名 -->
<div class="modal fade" id="editCompanyModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel">
    <div class="modal-dialog" role="document" style="width: 800px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h1 class="modal-title" style="text-align: center" >修改客户</h1>
            </div>
            <div class="modal-body" style="padding: 10px 10px 5px 10px">
                <div class="row" id="addCompanyDiv">
                    <div class="col-sm-12">
                        <form id="addCompanyForm" class="form-horizontal">
                            <div class="form-group">
                                <label class="col-sm-2 control-label">客户性质:<span class="text-red">*</span></label>
                                <div class="col-sm-8">
                                    <input type="hidden" name="custProperty" id="custProperty" value="1"/>
                                    <button type="button" id="enterpriseBtn" class="btn btn-info">&nbsp;企业客户&nbsp;
                                    </button>&nbsp;&nbsp;
                                    <button type="button" id="personalBtn" class="btn btn-white">&nbsp;个人客户&nbsp;
                                    </button>
                                </div>
                            </div>
                            <div class="form-group" style="position: relative;">
                                <label class="col-sm-2 control-label">公司名称:<span class="text-red">*</span></label>
                                <div class="col-sm-8">
                                    <input type="hidden" name="companyId"/>
                                    <input type="text" placeholder="请输入关键字(公司名、注册号或社会统一信用代码)搜索" class="form-control"
                                           name="companyName" autocomplete="off" required
                                           oninput="companyObj.search(this);"
                                           onblur="companyObj.checkCompany(this);"
                                           onkeydown="companyObj.enterEvent(this, event);"
                                           onmouseout="companyObj.mourseOut(this);"
                                           onmouseover="companyObj.mourseOver(this);"/>
                                    <div class="companyWrap companyPanelCancel" onmouseover="companyObj.mourseOver(this);" onmouseout="companyObj.mourseOut(this);"></div>
                                </div>
                                <div class="col-sm-2 control-label2">
                                    <span data-toggle="tooltip" data-placement="left" data-html="true"
                                          title="填写客户公司名称之后判定分为标准和非标准两类，企业客户有标准类型和非标准类型，个人客户都是非标准类型并且公司名称统一为个体工商户">
                                        <i class="fa fa-question-circle"></i>
                                    </span>
                                    <input type="hidden" name="standardize" id="standardize">
                                    <span id="companyTipsYes" class="companyTipsYes" style="display:none"><span class="text-green">&nbsp;<i
                                            class="fa fa-check-circle"></i>&nbsp;标准</span></span>
                                    <span id="companyTipsNo" class="companyTipsNo" style="display:none"><span class="text-red">&nbsp;<i
                                            class="fa fa-times-circle"></i>&nbsp;非标准</span></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">对接人名字:<span class="text-red">*</span></label>
                                <div class="col-sm-3">
                                    <input type="hidden" name="userId"/>
                                    <input type="text" class="form-control" name="userName" autocomplete="off"
                                           required="required">
                                </div>
                                <label class="col-sm-2 control-label">手机号:<span class="text-red">*</span></label>
                                <div class="col-sm-3">
                                    <input type="text" class="form-control" name="mobile" autocomplete="off"
                                           required="required" oninput="value=value.replace(/[^\d]/g,'');companyObj.regexPhone(this)">
                                </div>
                                <div class="col-sm-2 control-label2">
                                    <span data-toggle="tooltip" data-placement="left" data-html="true"
                                          title="填写手机号码之后判定分为规范和非规范两类">
                                        <i class="fa fa-question-circle"></i>
                                    </span>
                                    <input type="hidden" name="normalize" id="normalize">
                                    <span id="companyUserTipsYes" style="display: none"><span
                                            class="text-green">&nbsp;<i
                                            class="fa fa-check-circle"></i>&nbsp;规范</span></span>
                                    <span id="companyUserTipsNo" style="display: none"><span
                                            class="text-red">请输入正确的手机号</span></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">微信号:</label>
                                <div class="col-sm-3">
                                    <input type="text" class="form-control" autocomplete="off" name="wechat">
                                </div>
                                <label class="col-sm-2 control-label">QQ号:</label>
                                <div class="col-sm-3">
                                    <input type="text" class="form-control" autocomplete="off" name="qq" oninput="value=value.replace(/[^\d]/g,'')">
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group" style="margin-bottom: 0">
                                <label class="col-sm-2 control-label"><span class="text-red">温馨提示：</span></label>
                                <div class="col-sm-10">
                                    <span>1、企业客户开票：企业客户是强保护类型才能开票，开票公司名称为客户公司名称。<br/></span>
                                    <span>2、个人客户开票：个人客户手机号码规范才能开票，开票公司名称为对接人名字。</span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" id="updateCompanyBasicBtn" onclick="companyObj.updateCompanyBasic(this,'/crm/company/updateCompanyBasic')"><i
                        class="fa fa-save"></i>&nbsp;修改
                </button>
                <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭
                </button>
            </div>
        </div>
    </div>
</div>
</html>