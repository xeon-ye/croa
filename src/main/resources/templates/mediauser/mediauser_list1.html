<!DOCTYPE html>
<html lang="zh_CN" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common/head :: common_header(~{::title},~{::link},~{::script},~{::style})">
    <title>媒介管理</title>
    <link href="/layui/css/layui.css" rel="stylesheet">
    <link href="/css/plugins/toastr/toastr.min.css" rel="stylesheet">
    <link href="/css/plugins/iCheck/custom.css" rel="stylesheet">
    <script src="/js/plugins/toastr/toastr.min.js"></script>
    <!--模态框拖动-->
    <link rel="stylesheet" href="/css/plugins/jQueryUI/jquery-ui-1.10.4.custom.min.css" />
    <script src="/js/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="/layui/layui.js"></script>
    <script src="/js/plugins/layer/laydate/laydate.js"></script>
    <script src="/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <script src="/js/plugins/echarts/echarts-all.js"></script>
    <script type="text/javascript" src="/js/plugins/treeview/bootstrap-treeview.js"></script>
    <script type="text/javascript" src="/js/fee/commonFee.js"></script>
    <script th:src="@{/js/crm/common_util.js(v=${version})}"  data-th-inline="javascript"></script>
    <script th:src="@{/js/crm/commonDatagrid.js(v=${version})}"  data-th-inline="javascript"></script>
    <script th:src="@{/js/mediauser/mediauser_list1.js(v=${version})}"  data-th-inline="javascript"></script>
    <!--统计概况模态框Css-->
    <link href="/css/statisticsModal/statisticsModal.css" rel="stylesheet">
    <!--统计概况模态框Js-->
    <script src="/js/statisticsModal/statisticsModal.js"></script>
    <style>
        .narrow {
            padding-left: 3px;
            padding-right: 3px;
        }

        .ui-jqgrid-bdiv {
            overflow-x: scroll !important;
        }

        .layui-form-selected dl {
            width: 0px;
        }

        /*关于layer.open中的下拉列表被遮挡*/
        .layui-layer-page .layui-layer-content {
            position: relative;
            overflow: unset !important;
        }
    </style>
    <script th:inline="javascript">
        var grid = null;
        var mediaGrid = null;
        var mediaSupplierGrid = null;
        $(function () {
            var e = "<i class='fa fa-times-circle'></i> ";
            $("#publishEditForm").validate({
                rules: {
                    title: {required: true, minlength: 1, maxlength: 200},
                    //link: {required: true, minlength: 1, maxlength: 200},
                    issuedDate: {required: true}
                },
                messages: {
                    title: {required: e + "请输入标题", minlength: e + "标题的长度必须大于{0}", maxlength: e + "标题长度必须小于{0}"},
                    //link: {required: e + "请输入链接", minlength: e + "链接的长度必须大于{0}", maxlength: e + "链接长度必须小于{0}"},
                    issuedDate: {required: e + "请输入发稿日期"}
                }
            });

            $('.i-checks').iCheck({
                checkboxClass: 'icheckbox_square-green',
                radioClass: 'iradio_square-green'
            });

            var issuedDateStart = {
                elem: '#issuedDateStart',
                format: 'YYYY/MM/DD ',
                // min: laydate.now(), //设定最小日期为当前日期
                // max: laydate.now(),//最大日期
                istime: false,
                istoday: false,

            };
            var issuedDateEnd = {
                elem: '#issuedDateEnd',
                format: 'YYYY/MM/DD  ',
                //min: laydate.now(),
                //max: laydate.now(),
                istime: false,
                istoday: false,

            };
            var issuedDate = {
                elem: '#issuedDate',
                format: 'YYYY-MM-DD',
                //min: laydate.now(),
                // max: laydate.now(),
                istime: false,
                istoday: false,

            };
            laydate(issuedDateStart);
            laydate(issuedDateEnd);
            laydate(issuedDate);
            //加载时间控件
            /*  var issuedDateStart = {
                  elem: '#issuedDateStart',
                  format: 'YYYY/MM/DD',
                  istime: true,
                  istoday: false
              };
              laydate(issuedDateStart);
              issuedDateStart.elem = '#issuedDateEnd';
              laydate(issuedDateStart);*/
            statisticsModal.init();//初始化模态框

            Views.loadParentMediaType("mType");
            // 加载所有业务员；
            listPart("#userId");
            // Views.loadAllYW("salesmanName", user.id);
            // // 加载媒介；
            // listPastMedia("#mediaUserName");

            //新增页面选择板块、业务员
            loadTypeByUserId("mTypeName2");
            listPartAll2("#userId2");

            // 批量修改页面选择业务员
            listPartAll2("#userId3");

            //创建表格对象
            grid = new dataGrid("table", gridObject, "pager", "searchForm");
            grid.loadGrid(); //加载表格
            // $("#table").setGridHeight(390);

            //创建媒体信息表格对象
            mediaGrid = new dataGrid("media_table_logs", mediaGridObject, "media_pager_logs", "mediaForm");

            //创建媒体供应商信息表格对象
            mediaSupplierGrid = new dataGrid("mediaSupplierTable", mediaSupplierGridObject, "mediaSupplierTable", "mediaSupplierForm");
        });

        function changeEvent() {
            grid.setPageSelected('artId');
            grid.search();
        }

        //回车事件
        function enterEvent(event) {
            if ((event.keyCode == '13' || event.keyCode == 13)) {
                grid.setPageSelected('artId');
                grid.search();
            }
        }
    </script>
</head>
<body>
<!--查询条件-->
<div class="row">
    <div class="col-sm-12">
        <div class="ibox" style="margin-bottom: 0px">
            <div class="ibox-title" style="padding-left: 20px">
                <h5 style="font-weight: bold">查询条件</h5>
            </div>
            <div class="ibox-content" style="padding: 15px 0px 0px 5px">
                <div id="queryDiv">
                    <form  id="searchForm" class="form-horizontal">
                        <div class="form-group">
                            <label class="col-sm-1 control-label narrow">业务员所属公司:</label>
                            <div class="col-sm-1 narrow">
                                <select class="form-control" name="companyCode" id="companyCode"
                                        onchange="changeEvent();">
                                </select>
                            </div>
                            <input type="hidden" name="selectType" value="MJ"/>
                            <div class="col-sm-2 narrow" style="text-align:center">
                                <div class="input-group m-b" style="margin-bottom: 0">
                                    <input type="hidden" id="deptId" name="deptId" class="height18">
                                    <input type="text" id="deptName" class="form-control height18" readonly="readonly" placeholder="业务部门">
                                    <span class="input-group-addon btn btn-primary glyphicon glyphicon-search"
                                          style="top: 0px;border: 1px solid #1ab394;border-radius: 3px;background-color: #1ab394;color: #FFFFFF" id="selDept"
                                          data-toggle="tooltip" data-placement="top" data-html="true" title="选择部门"></span>
                                    <span class="input-group-addon btn btn-primary glyphicon glyphicon-remove"
                                          style="top: 0px;border: 1px solid #f8ac59;border-radius: 3px;background-color: #f8ac59;color: #FFFFFF" id="cleanDept"
                                          data-toggle="tooltip" data-placement="top" data-html="true" title="清除选择的部门"></span>
                                </div>
                            </div>
                            <div class="col-sm-2 layui-form narrow">
                                <select lay-verify="" lay-search name="userId" id="userId"
                                        class="form-control height18" onchange="changeEvent();">
                                    <option value="">业务员</option>
                                </select>
                            </div>
                            <div class="col-sm-2 narrow">
                                <input type="text" name="link"
                                       class="form-control height18" placeholder="链接" onkeydown="enterEvent(event);">
                            </div>
                            <div class="col-sm-1 narrow">
                                <input type="text" name="electricityBusinesses"
                                       class="form-control height18" placeholder="电商商家" onkeydown="enterEvent(event);">
                            </div>
                            <div class="col-sm-1 narrow">
                                <input type="text" name="channel"
                                       class="form-control height18" placeholder="频道" onkeydown="enterEvent(event);">
                            </div>
                            <div class="col-sm-2 narrow">
                                <select name="innerOuter" class="form-control height18" onchange="changeEvent();">
                                    <option value="">内外部</option>
                                    <option value="内部">内部</option>
                                    <option value="外部">外部</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-1 control-label narrow">媒体板块：</label>
                            <div class="col-sm-1 narrow">
                                <select name="mType" class="form-control height18" onchange="changeEvent();">
                                    <option value="">全部板块</option>
                                </select>
                            </div>
                            <div class="col-sm-2 narrow" style="text-align:center">
                                <div class="input-group m-b" style="margin-bottom: 0">
                                    <input type="hidden" id="mjDeptId" name="mjDeptId" class="height18">
                                    <input type="text" id="mjDeptName" class="form-control height18" readonly="readonly" placeholder="媒介部门">
                                    <span class="input-group-addon btn btn-primary glyphicon glyphicon-search"
                                          style="top: 0px;border: 1px solid #1ab394;border-radius: 3px;background-color: #1ab394;color: #FFFFFF" id="mjDeptSel"
                                          data-toggle="tooltip" data-placement="top" data-html="true" title="选择部门"></span>
                                    <span class="input-group-addon btn btn-primary glyphicon glyphicon-remove"
                                          style="top: 0px;border: 1px solid #f8ac59;border-radius: 3px;background-color: #f8ac59;color: #FFFFFF" id="mjDeptClear"
                                          data-toggle="tooltip" data-placement="top" data-html="true" title="清除选择的部门"></span>
                                </div>
                            </div>
                            <div class="col-sm-2 layui-form narrow">
                                <select lay-verify="" lay-search name="mediaUserId" id="mediaUserName"
                                        class="form-control height18" onchange="changeEvent();">
                                    <option value="">媒介</option>
                                </select>
                            </div>
                            <div class="col-sm-2 narrow">
                                <input type="text" name="mediaName"
                                       class="form-control height18" placeholder="媒体" onkeydown="enterEvent(event);">
                            </div>
                            <div class="col-sm-2 narrow">
                                <input type="text" id="supplierName" name="supplierName"
                                       class="form-control height18" placeholder="供应商名称" onkeydown="enterEvent(event);">
                            </div>
                            <div class="col-sm-2 narrow">
                                <input type="text" id="supplierContactor" name="supplierContactor"
                                       class="form-control height18" placeholder="供应商联系人"
                                       onkeydown="enterEvent(event);">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-1 control-label narrow">发布时间：</label>
                            <div class="col-sm-2 narrow">
                                <input placeholder="开始日期" style="width:48%;padding-left:5px; padding-right:5px;vertical-align: middle"
                                       class="form-control layer-date" id="issuedDateStart"
                                       name="issuedDateStart" readonly="readonly">
                                <input placeholder="结束日期" style="width:48%;padding-left:5px; padding-right:5px;vertical-align: middle"
                                       class="form-control layer-date" id="issuedDateEnd"
                                       name="issuedDateEnd" readonly="readonly">
                            </div>
                            <div class="col-sm-1 narrow">
                                <select name="issueStates" class="form-control height18" onchange="changeEvent();">
                                    <option value="">发布状态</option>
                                    <option value="1">待安排</option>
                                    <option value="2">进行中</option>
                                    <option value="4">已发布</option>
                                </select>
                            </div>
                            <div class="col-sm-2 narrow">
                                <input type="text" name="title"
                                       class="form-control height18" placeholder="稿件标题" onkeydown="enterEvent(event);">
                            </div>
                            <div class="col-sm-2 narrow">
                                <select name="completeStatus" class="form-control height18" onchange="changeEvent();">
                                    <option value="">客户状态</option>
                                    <option value="0">未完善客户</option>
                                    <option value="1">已完善客户</option>
                                </select>
                            </div>
                            <div class="col-sm-1 narrow">
                                <select name="outgoStates" class="form-control height18" onchange="changeEvent();">
                                    <option value="">请款状态</option>
                                    <option value="0">未请款</option>
                                    <option value="1">已请款</option>
                                    <option value="2">请款中</option>
                                </select>
                            </div>
                            <div class="col-sm-1 narrow">
                                <select name="commissionStates" class="form-control height18" onchange="changeEvent();">
                                    <option value="">提成状态</option>
                                    <option value="0">未提成</option>
                                    <option value="2">已登记</option>
                                </select>
                            </div>
                            <div class="col-sm-1">
                                <button type="button" id="searchButton" class="btn btn-primary"
                                        onclick="grid.setPageSelected('artId');grid.search();">
                                    <i class="fa fa-search"></i>&nbsp;&nbsp;搜索
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!--统计-->
<div class="row">
    <div class="col-sm-12">
        <div class="ibox">
            <div class="ibox-content" id="tj" style="padding: 5px 0px 0px 5px">
                <div class="col-sm-4" style="text-align: center;">
                    <label>报价合计: ￥ </label><label id="saleAmountSum" class="text-danger">0</label>
                </div>
                <div class="col-sm-4" style="text-align: center;">
                    <label>执行前价格合计: ￥ </label><label id="payAmountSum" class="text-danger">0</label>
                </div>
                <div class="col-sm-4" style="text-align: center;">
                    <label>执行后价格（应付）合计: ￥ </label><label id="outgoAmountSum" class="text-danger">0</label>
                </div>
            </div>
        </div>
    </div>
</div>
<!--表格-->
<div class="row">
    <div class="col-sm-12">
        <div class="ibox">
            <div class="ibox-title" style="padding-left: 20px">
                <button id="addBtn" class="btn btn-success" type="button" onclick="Business.addBtn();">
                    <i class="fa fa-plus"></i>&nbsp;&nbsp;新增稿件
                </button>
                <button id="importBtn" class="btn btn-primary" type="button" onclick="Business.importBtn();">
                    <i class="fa fa-sign-in"></i>&nbsp;&nbsp;批量导入
                </button>
                <button id="batchEditBtn" class="btn btn-info" type="button" onclick="Business.batchUpdateBtn();">
                    <i class="fa fa-sign-in"></i>&nbsp;&nbsp;批量修改
                </button>
                <button class="btn btn-default" type="button" onclick="Business.exportArt();">
                    <i class="fa fa-external-link"></i>&nbsp;&nbsp;导出选中
                </button>
                <button class="btn btn-warning" type="button" onclick="Business.exportAll();">
                    <i class="fa fa-external-link"></i>&nbsp;&nbsp;导出全部
                </button>
                <button class="btn btn-danger" type="button" onclick="Business.batchDelete();">
                    <i class="fa fa-trash-o"></i>&nbsp;&nbsp;批量删除
                </button>
                <button class="btn btn-success" type="button" onclick="Business.exportTemplate();">
                    <i class="fa fa-external-link"></i>&nbsp;&nbsp;导出模板
                </button>
            </div>
            <div class="ibox-content" style="padding: 5px 0px 0px 5px">
                <div class="jqGrid_wrapper">
                    <table id="table"></table>
                    <div id="pager"></div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<!--导出不能用ajax，所以用表单-->
<form action="/article/exportArticleMJ" method="post" id="exportForm">
    <input name="datas" type="hidden">
</form>
<!--稿件移交-->
<div id="artTransferModal" style="display: none;">
    <form id="transferForm1" class="form-horizontal layui-form" action=""  type="post">
        <input type="hidden" name="artId"/>
        <input type="hidden" name="mediaUserName"/>
        <div class="form-group col-sm-12" style="margin-top: 10px;">
            <label class="col-sm-2 control-label">
                <span class="text-red">*</span>媒介:
            </label>
            <div class="col-sm-10">
                <select name="mediaUserId" class="form-control height18" lay-search lay-filter="mediaUserId">

                </select>
            </div>
        </div>
    </form>
</div>
<!--发布时弹出的魔态框-->
<div id="publishEditModal" class="modal inmodal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" style="width:800px;height: 300px;">
        <div class="modal-content animated bounceInRight">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>稿件发布</h5>
                </div>
                <div class="ibox-content">
                    <div>
                        <form id="publishEditForm" class="form-horizontal">
                            <input type="hidden" id="id" name="id" class="form-control">
                            <div class="row">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label right0">
                                        <span class="text-red">*</span>发布时间：
                                    </label>
                                    <div class="col-sm-3">
                                        <input class="form-control layer-date laydate-icon" name="issuedDate" required
                                               id="issuedDate" style="margin-left:0;vertical-align: middle">
                                    </div>
                                    <div class="col-sm-1">
                                    </div>
                                    <label class="col-sm-2 control-label right0">
                                        <i style="color: #0a6aa1;font-size: 10px;"
                                           title="说明：如果发布稿件时单价比对应媒体类型的价格单价浮动超过5%时，则询问是否同时修改媒体价格的审核，确定则发起修改媒体价格的审核。"
                                           class="glyphicon glyphicon-question-sign"></i>
                                        是否更新成本价：
                                    </label>
                                    <div class="col-sm-3 i-checks" style="position: relative;left:15px;top:5px;">
                                        <input name="updatePrice" type="checkbox" value="1"> <i></i>
                                    </div>
                                    <div class="col-sm-1">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-sm-2 control-label right0"><span class="text-red">*</span>标题：</label>
                                    <div class="col-sm-9">
                                        <input class="form-control" name="title" required>
                                    </div>
                                    <div class="col-sm-1">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-sm-2 control-label right0"><span class="text-red">*</span>链接：</label>
                                    <div class="col-sm-3">
                                        <input class="form-control" name="link" required>
                                    </div>
                                    <div class="col-sm-1">
                                    </div>
                                    <label class="col-sm-2 control-label right0"><span class="text-red">*</span>执行后价格：</label>
                                    <div class="col-sm-3">
                                        <input class="form-control" name="outgoAmount" required onkeyup="value=value.replace(/[^\d\.]/g,'')">
                                    </div>
                                    <div class="col-sm-1">
                                    </div>
                                </div>


                                <div class="form-group" style="margin-top:30px;">
                                    <div class="col-sm-12 col-sm-offset-5">
                                        <button class="btn btn-primary" onclick="Business.zxPublish()" type="button">
                                            保存内容
                                        </button>
                                        <button class="btn btn-white backButton" type="button" data-dismiss="modal"
                                                id="clo">关闭
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
<!--新增模态框-->
<div class="modal inmodal" id="addModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog" style="width: 100%">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header" style="padding: 10px">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h4 class="modal-title">新增稿件</h4>
            </div>
            <div class="modal-body" style="padding: 0">
                <div class="row">
                    <div class="col-sm-12">
                        <form id="addForm" class="form-horizontal" action="" type="post">
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>媒体板块:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="hidden" name="mediaTypeId" id="mediaTypeId2">
                                    <input type="hidden" name="mediaTypeName">
                                    <select id="mTypeName2" name="mTypeName" class="form-control height18"
                                            required>
                                        <option value="">请选择</option>
                                    </select>
                                </div>
                                <div class="col-sm-1  narrow">

                                </div>
                                <label class="col-sm-1 control-label  narrow">
                                    <span class="text-red">*</span>业务员:
                                </label>
                                <div class="col-sm-2 layui-form narrow">
                                    <select lay-search name="userId" id="userId2" required
                                            class="form-control height18">
                                        <option value="">请选择</option>
                                    </select>
                                </div>
                                <label class="col-sm-1 control-label  narrow">
                                    <span class="text-red">*</span>媒介:
                                </label>
                                <div class="col-sm-2 layui-form narrow">
                                    <input type="hidden" name="mediaUserId">
                                    <input type="hidden" name="mediaUserName">
                                    <select lay-search lay-filter="mediaUserFilter" required
                                            name="mediaUserNameSec" id="mediaUserNameSec" model="select"
                                            class="form-control height18">
                                    </select>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 30px">
                                <label class="col-sm-2 control-label  narrow">
                                    <span class="text-red">*</span>媒体:
                                </label>
                                <div class="col-sm-8 narrow">
                                    <input type="hidden" name="mediaId" class="form-control height18">
                                    <input type="hidden" name="mediaPersonId"/>
                                    <input type="text" name="mediaName" class="form-control height18" readonly="readonly" required>
                                </div>
                                <div class="col-sm-1 narrow" id="selectMediaBtns1" style="text-align: center;">
                                    <button type="button"
                                            class="btn btn-primary btn-circle glyphicon  glyphicon-search"
                                            id="selMedia1" onclick="javascript:Business.mediaModalShow1()"></button>
                                    <button type="button"
                                            class="btn btn-warning btn-circle glyphicon  glyphicon-remove"
                                            id="cleanMedia1"
                                            onclick="javascript:Business.cleanMediaInfo1()"></button>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 30px">
                                <label class="col-sm-2 control-label narrow">
                                    供应商公司:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="hidden" name="supplierId" class="form-control height18">
                                    <input type="hidden" name="supplierPersonId"/>
                                    <input type="text" name="supplierName" class="form-control height18" readonly="readonly">
                                </div>
                                <label class="col-sm-2 control-label narrow">
                                    供应商对接人:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="supplierContactor" class="form-control height18" readonly="readonly">
                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    供应商电话:
                                </label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" id="supplierPhoneAdd" class="form-control height18" readonly="readonly">
                                </div>
                                <div class="col-sm-1 narrow" style="text-align: center;">
                                    <button type="button"
                                            class="btn btn-primary btn-circle glyphicon  glyphicon-search"
                                            onclick="javascript:Business.mediaSupplierModalShow1(this);"></button>
                                    <button type="button"
                                            class="btn btn-warning btn-circle glyphicon  glyphicon-remove"
                                            onclick="javascript:Business.cleanMediaSupplierInfo1();"></button>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">内外部:</label>
                                <div class="col-sm-2 narrow">
                                    <select id="innerOuter" name="innerOuter" class="form-control height18">
                                        <option value="">请选择</option>
                                        <option value="内部">内部</option>
                                        <option value="外部">外部</option>
                                    </select>
                                </div>
                                <div class="col-sm-1 narrow">

                                </div>
                                <label class="col-sm-1 control-label narrow">频道:</label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="channel" class="form-control height18">
                                </div>
                                <label class="col-sm-1 control-label narrow">电商商家:</label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="electricityBusinesses" class="form-control height18">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>标题:
                                </label>
                                <div class="col-sm-9 narrow">
                                    <input type="text" name="title" class="form-control height18" required="">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>链接:
                                </label>
                                <div class="col-sm-9 narrow">
                                    <input type="text" name="link" class="form-control height18" required="">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>价格类型:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <select id="priceType" name="priceType" class="form-control height18"
                                            required>
                                        <option value="">请选择</option>
                                    </select>
                                </div>
                                <div class="col-sm-1 narrow">

                                </div>
                                <label class="col-sm-1 control-label narrow">单价:</label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" name="unitPrice" class="form-control height18"
                                           readonly="readonly">
                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    <span class="text-red">*</span>数量:
                                </label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" name="num" class="form-control height18" required
                                           onkeyup="value=value.replace(/[^\d]/g,'')" oninput="calcuteUnitPriceAdd()">
                                </div>
                                <label class="col-sm-1 control-label narrow">其他费用:</label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" name="otherExpenses" class="form-control height18"
                                           onkeyup="value=value.replace(/[^\d\.]/g,'')" oninput="calcuteUnitPriceAdd()">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>发布时间：
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input class="form-control laydate-icon" name="issuedDate" required
                                           readonly="readonly"
                                           onclick="laydate({istime: true, format: 'YYYY-MM-DD'})">
                                </div>
                                <div class="col-sm-1 narrow">

                                </div>
                                <label class="col-sm-1 control-label narrow">执行前价格:</label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="payAmount" class="form-control height18"
                                           onkeyup="value=value.replace(/[^\d\.]/g,'')"  >
                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    <span class="text-red">*</span>执行后价格:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="outgoAmount" class="form-control height18"
                                           onkeyup="value=value.replace(/[^\d\.]/g,'')" required oninput="calcuteUnitPriceAdd()">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label narrow">备注:</label>
                                <div class="col-sm-9 narrow">
                                    <textarea type="text" name="remarks" class="form-control" style="height: 60px;"></textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label narrow">附件:</label>
                                <div class="col-sm-3 narrow">
                                    <input type="file" id="file2" name="file" class="form-control" multiple/>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" id="insertButton"
                        onclick="insert()"><i class="fa fa-save"></i>&nbsp;保存
                </button>
                <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭</button>
            </div>
        </div>
    </div>
</div>
<!--编辑模态框-->
<div class="modal inmodal" id="editModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog" style="width: 100%">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header" style="padding: 10px">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h4 class="modal-title">编辑稿件</h4>
            </div>
            <div class="modal-body" style="padding: 0">
                <div class="row" id="addAccountDiv">
                    <div class="col-sm-12">
                        <form id="editForm" class="form-horizontal" action="" type="post">
                            <input type="hidden" id="id1" name="id" class="form-control">
                            <div class="form-group" id="dockingInfo" style="margin-top: 20px">
                                <input type="text" id="artId" name="artId" style="display:none"
                                       class="form-control height18">
                                <input type="hidden" name="userId" style="display:none"
                                       class="form-control height18">
                                <input type="hidden" name="oldPromiseDate"/>
                                <input type="hidden" name="oldIssuedDate"/>
                                <label class="col-sm-2 control-label narrow">
                                    <span  class="text-red">*</span>媒体板块:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="hidden" name="mTypeId" id="mTypeId" class="form-control height18">
                                    <input type="text" name="mTypeName" id="mTypeName" class="form-control height18"
                                           required
                                           readonly="readonly">
                                </div>
                                <div class="col-sm-1 narrow">

                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    <span class="text-red">*</span>业务员:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="userName" id="userName" class="form-control height18"
                                           required
                                           readonly="readonly">
                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    <span class="text-red">*</span>媒介:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="hidden" name="mediaUserId">
                                    <input type="text" id="mediaUserName1" name="mediaUserName" required
                                           class="form-control height18" readonly="readonly">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 30px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>媒体:
                                </label>
                                <div class="col-sm-8 narrow">
                                    <input type="hidden" name="mediaId"
                                           class="form-control height18" readonly="readonly">
                                    <input type="text" name="mediaName"
                                           class="form-control height18" readonly="readonly" required>
                                </div>
                                <div class="col-sm-1 narrow">
                                    <button type="button"
                                            class="btn btn-primary btn-circle glyphicon  glyphicon-search selectMediaBtns"
                                            id="selMedia" onclick="javascript:Business.mediaModalShow()"></button>
                                    <button type="button"
                                            class="btn btn-warning btn-circle glyphicon  glyphicon-remove selectMediaBtns"
                                            id="cleanMedia" onclick="javascript:Business.cleanMediaInfo()"></button>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 30px">
                                <label class="col-sm-2 control-label narrow">
                                    供应商公司:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="hidden" name="supplierId" class="form-control height18">
                                    <input type="text" name="supplierName" class="form-control height18" readonly="readonly">
                                </div>
                                <label class="col-sm-2 control-label narrow">
                                    供应商对接人:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="supplierContactor" class="form-control height18" readonly="readonly">
                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    供应商电话:
                                </label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" id="supplierPhone" class="form-control height18" readonly="readonly">
                                </div>
                                <div class="col-sm-1 narrow" id="selectMediaSupplierBtns">
                                    <button type="button"
                                            class="btn btn-primary btn-circle glyphicon glyphicon-search"
                                            onclick="javascript:Business.mediaSupplierModalShow(this);"></button>
                                    <button type="button"
                                            class="btn btn-warning btn-circle glyphicon  glyphicon-remove"
                                            onclick="javascript:Business.cleanMediaSupplierInfo();"></button>
                                </div>
                            </div>
                            <div class="form-group licence" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">内外部:</label>
                                <div class="col-sm-2 narrow">
                                    <select id="innerOuter1" name="innerOuter" class="form-control height18">
                                        <option value="">请选择</option>
                                        <option value="内部">内部</option>
                                        <option value="外部">外部</option>
                                    </select>
                                </div>
                                <div class="col-sm-1 narrow">

                                </div>
                                <label class="col-sm-1 control-label narrow">频道:</label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="channel" class="form-control height18">
                                </div>
                                <label class="col-sm-1 control-label narrow">电商商家:</label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="electricityBusinesses" class="form-control height18">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>标题:
                                </label>
                                <div class="col-sm-9 narrow">
                                    <input type="text" name="title" class="form-control height18" required>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>链接:
                                </label>
                                <div class="col-sm-9 narrow">
                                    <input type="text" name="link"
                                           class="form-control height18" required>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>价格类型:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" name="priceType" class="form-control height18"
                                           readonly="readonly" required>
                                </div>
                                <div class="col-sm-1 narrow">

                                </div>
                                <label class="col-sm-1 control-label narrow">单价:</label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" name="unitPrice" class="form-control height18"
                                           readonly="readonly">
                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    <span class="text-red">*</span>数量:
                                </label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" name="num" class="form-control height18" required
                                           onkeyup="value=value.replace(/[^\d]/g,'')" oninput="calcuteUnitPrice()">
                                </div>
                                <label class="col-sm-1 control-label narrow">其他费用:</label>
                                <div class="col-sm-1 narrow">
                                    <input type="text" name="otherExpenses" class="form-control height18"
                                           onkeyup="value=value.replace(/[^\d\.]/g,'')" oninput="calcuteUnitPrice()">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label narrow">
                                    <span class="text-red">*</span>发布时间：
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input class="form-control laydate-icon" id="issuedDate1" name="issuedDate"
                                           required readonly="readonly"
                                           onclick="laydate({istime: true, format: 'YYYY-MM-DD'})">
                                </div>
                                <div class="col-sm-1 narrow">

                                </div>
                                <label class="col-sm-1 control-label narrow">执行前价格:</label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" id="payAmount" name="payAmount" class="form-control height18"
                                           onkeyup="value=value.replace(/[^\d\.]/g,'')">
                                </div>
                                <label class="col-sm-1 control-label narrow">
                                    <span class="text-red">*</span>执行后价格:
                                </label>
                                <div class="col-sm-2 narrow">
                                    <input type="text" id="outgoAmount" name="outgoAmount"
                                           class="form-control height18"
                                           onkeyup="value=value.replace(/[^\d\.]/g,'')" required oninput="calcuteUnitPrice()">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label narrow">备注:</label>
                                <div class="col-sm-9 narrow">
                                        <textarea type="text" id="remarks1" name="remarks"
                                                  class="form-control" style="height: 60px;"></textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label narrow">附件:</label>
                                <div class="col-sm-3 narrow">
                                    <input type="file" id="file1" name="file" class="form-control" multiple/>
                                </div>
                                <div class="col-sm-6 narrow">
                                    <span id="fileInfo1"></span>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" id="saveButton"
                        onclick="update()"><i class="fa fa-save"></i>&nbsp;保存
                </button>
                <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭</button>
            </div>
        </div>
    </div>
</div>
<!--搜索条件选择部门-->
<div class="modal inmodal" id="deptModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h1>选择业务部门</h1>
            </div>
            <div class="modal-body" style="padding: 0px">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="ibox" style="margin-bottom: 0">
                            <div class="ibox-content">
                                <div id="treeview"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭
                </button>
            </div>
        </div>
    </div>
</div>
<!--搜索条件选择部门-->
<div class="modal inmodal" id="mjDeptModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h1>选择媒介部门</h1>
            </div>
            <div class="modal-body" style="padding: 0px">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="ibox" style="margin-bottom: 0">
                            <div class="ibox-content">
                                <div id="mjTreeview"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal"><i class="fa fa-close"></i>&nbsp;关闭
                </button>
            </div>
        </div>
    </div>
</div>
<!--批量导入稿件-->
<div class="modal inmodal" id="importModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <form id="importForm" class="form-horizontal" action="" type="post" enctype="multipart/form-data">
            <div class="modal-content animated bounceInRight">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span
                            aria-hidden="true">&times;</span><span class="sr-only">关闭</span>
                    </button>
                    <h4 class="modal-title">批量导入稿件</h4>
                </div>
                <div class="ibox-content">
                    <div>
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">上传excel:</label>
                                    <div class="col-sm-10">
                                        <a id="" href="">
                                            <span id="affixName"></span>
                                        </a>
                                        <input type="file" id="file" name="file" class="form-control">
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="submitImportBtn"
                            onclick="javascript:Business.batchImport()">批量导入
                    </button>
                    <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </form>
    </div>
</div>
<!--新增稿件媒体列表-->
<div class="modal inmodal" id="mediaModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog"  style="width: 100%">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header" style="padding: 15px;">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h4 class="modal-title ">选择媒体信息</h4>
            </div>
            <div class="ibox-content">
                <div class="">
                    <form id="mediaForm">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="">
                                    <div class="form-horizontal">
                                        <div class="form-group">
                                            <div id="mediaContentIdWrap">
                                                <label class="col-sm-1 control-label" style="padding-left: 0px !important;">唯一标识:</label>
                                                <div class="col-sm-2">
                                                    <input type="text" name="mediaContentId"  class="form-control">
                                                </div>
                                            </div>
                                            <label class="col-sm-1 control-label" style="padding-left: 0px !important;">媒体名称:</label>
                                            <div class="col-sm-2">
                                                <input type="text" name="mediaName" class="form-control">
                                            </div>
                                            <div class="col-sm-1">
                                                <input type="hidden" name="plateId" id="plateId">
                                                <button type="button" id="mediaSearch" class="btn btn-primary">
                                                    <i class="fa fa-search"></i>&nbsp;&nbsp;搜索
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="ibox ">
                                <div class="ibox-content">
                                    <div class="jqGrid_wrapper">
                                        <table id="media_table_logs"></table>
                                        <div id="media_pager_logs"></div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <input type="hidden" id="opType">
                                    <button type="button" class="btn btn-primary" id="selectMedia"
                                            onclick="javascript:Business.selectMedia()">选择
                                    </button>
                                    <button type="button" class="btn btn-white" id="cancelMedia"
                                            onclick="javascript:Business.cancelMedia()">关闭
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--稿件媒体供应商列表-->
<div class="modal inmodal" id="mediaSupplierModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog"  style="width: 100%">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header" style="padding: 15px;">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
                        class="sr-only">关闭</span>
                </button>
                <h4 class="modal-title ">选择媒体供应商信息</h4>
            </div>
            <div class="ibox-content">
                <div class="">
                    <form id="mediaSupplierForm">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="">
                                    <div class="form-horizontal">
                                        <div class="form-group">
                                            <label class="col-sm-1 control-label" style="padding-left: 0px !important;">供应商名称:</label>
                                            <div class="col-sm-2">
                                                <input type="text" name="supplierCompanyName"
                                                       class="form-control">
                                            </div>
                                            <label class="col-sm-1 control-label" style="padding-left: 0px !important;">供应商对接人:</label>
                                            <div class="col-sm-2">
                                                <input type="text" name="supplierName"
                                                       class="form-control">
                                            </div>
                                            <div class="col-sm-1">
                                                <input type="hidden" name="mediaId" id="mediaId">
                                                <button type="button" id="mediaSupplierSearch" class="btn btn-primary">
                                                    <i class="fa fa-search"></i>&nbsp;&nbsp;搜索
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="ibox ">
                                <div class="ibox-content">
                                    <div class="jqGrid_wrapper">
                                        <table id="mediaSupplierTable"></table>
                                        <div id="mediaSupplierTablePaper"></div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <input type="hidden" id="opType1">
                                    <button type="button" class="btn btn-primary" id="selectMediaSupplier"
                                            onclick="javascript:Business.selectMediaSupplier()">选择
                                    </button>
                                    <button type="button" class="btn btn-white" id="cancelMediaSupplier"
                                            onclick="javascript:Business.cancelMediaSupplier()">关闭
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- 批量修改  -->
<div class="modal inmodal" id="batchUpdateModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
    <div class="modal-dialog" style="width:800px">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header" style="padding: 15px;">
                <button type="button" class="close" data-dismiss="modal"><span
                        aria-hidden="true">&times;</span><span class="sr-only">关闭</span>
                </button>
                <h4 class="modal-title">批量修改稿件</h4>
            </div>
            <div class="modal-body" style="padding: 0px 30px 0px 30px;">
                <div class="row">
                    <div class="col-sm-12">
                        <form id="batchUpdateForm" class="form-horizontal" action="" type="post">
                            <input id="batchUpdateIds" type="hidden" name ="ids" />
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label right0">
                                    业务员:
                                </label>
                                <div class="col-sm-4 layui-form">
                                    <select lay-search name="userId" id="userId3"
                                            class="form-control height18">
                                        <option value="">请选择</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label right0">
                                    标题:
                                </label>
                                <div class="col-sm-9">
                                    <input type="text" name="title" class="form-control height18">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label right0">
                                    请款金额:
                                </label>
                                <div class="col-sm-4">
                                    <input type="text" name="outgoAmount" class="form-control height18" onkeyup="value=value.replace(/[^\d\.]/g,'')">
                                </div>
                            </div>
                            <div class="form-group" style="margin-top: 20px">
                                <label class="col-sm-2 control-label right0">
                                    发布时间:
                                </label>
                                <div class="col-sm-4">
                                    <input class="form-control laydate-icon" name="issuedDate"
                                           readonly="readonly"
                                           onclick="laydate({istime: true, format: 'YYYY-MM-DD'})">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 control-label right0">备注:</label>
                                <div class="col-sm-9">
                                    <textarea type="text" name="remarks" class="form-control" style="height: 60px;"></textarea>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <span>提示：如果选中的稿件有请款或提成，不能修改业务员和报价&nbsp;&nbsp;</span>
                <button type="button" class="btn btn-success" id="batchUpdateButton"
                        onclick="batchUpdate()"><i class="fa fa-save"></i>&nbsp;批量修改
                </button>
                <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>
<div style="display:none">
    <a onfocus="this.blur();" download="稿件导入失败详情.txt" id="createInvote" class="ipt-todo hide"></a>
</div>
<!--统计模态框导入-->
<div th:include="statisticsmodal/statisticsModal" ></div>
</html>

